<label for="tag">Tags</label>
<% list = ['jester', 'java', 'javascript', 'jump'] %>
<ul id="tags_list">

</ul>

<div id="tags" class="ui-helper-clearfix">
  <input type="text" 
          placeholder="Add Tag"
          name="tags[tags_attributes][title]" 
          id="tag_input">
</div>


<script>
$(function(){
  var titles = [];
  var ids = [];
  var templateFn = JST['add_tag']
  $('#tag_input').autocomplete({
                          source: getList(),
                          appendTo: '#tags',
                          autoFocus: true
  });

  function getList(){
    $.ajax({
      type: "GET",
      url: "/tags",
      success: function(data){
        var tags = $(data);
        _(tags).each(function(tag){
          titles.push(tag.title)
          ids.push(tag.id)
        })
        console.log(titles)

      }
    })
    return titles;

  }
  $('#tag_input').keydown(function (e){
    if(e.keyCode == 13){
      console.log(this.value);
      var template = templateFn({tag: this.value})
      $('#tags_list').append(template);
      this.value = '';
    }
  })
})

</script>
